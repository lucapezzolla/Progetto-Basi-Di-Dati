CREATE TABLE DIPENDENTE(
NOME_DIP VARCHAR2(20) NOT NULL,
COGNOME_DIP VARCHAR2(20) NOT NULL,
CF_DIP CHAR(16) PRIMARY KEY,
DATA_NASCITA_DIP DATE NOT NULL,
NUMERO_TEL_DIP CHAR(10) NOT NULL,
CAP_DIP VARCHAR2(20),
CITTA_DIP VARCHAR2(20),
VIA_DIP VARCHAR2(20));

CREATE TABLE RICHIAMO(
CF_RIC CHAR(16) NOT NULL,
MOTIVAZIONE VARCHAR2(20) NOT NULL,
DATA_RIC DATE NOT NULL,
ENTITA NUMBER NOT NULL,
CONSTRAINT PK_RICHIAMO PRIMARY KEY (CF_RIC,DATA_RIC), 
CONSTRAINT FK_RICHIAMO FOREIGN KEY (CF_RIC) REFERENCES DIPENDENTE(CF_DIP)
ON DELETE CASCADE,
CONSTRAINT Motive CHECK(MOTIVAZIONE IN('LOW_HOURS','RITARDO','CATTIVO')),
CONSTRAINT Entity CHECK (ENTITA BETWEEN 1 and 4)
);

CREATE TABLE STIPENDIO(
CF_STIP CHAR(16) NOT NULL,
IMPORTO NUMBER NOT NULL,
TRATTENUTE NUMBER,
DATA_STIP DATE NOT NULL,
CONSTRAINT PK_STIP PRIMARY KEY (CF_STIP,DATA_STIP),
CONSTRAINT FK_STIP FOREIGN KEY (CF_STIP) REFERENCES DIPENDENTE(CF_DIP)
ON DELETE CASCADE);

CREATE TABLE PRESENZE(
CF_PRES CHAR(16) NOT NULL,
DATA_INIZIO_PRES DATE NOT NULL,
DATA_FINE_PRES DATE NOT NULL,
CONSTRAINT PK_PRES PRIMARY KEY (CF_PRES,DATA_INIZIO_PRES),
CONSTRAINT FK_PRES FOREIGN KEY (CF_PRES) REFERENCES DIPENDENTE(CF_DIP)
ON DELETE CASCADE
);

CREATE TABLE NEGOZIO(
CAP_NEG VARCHAR2(20),
CITTA_NEG VARCHAR2(20),
VIA_NEG VARCHAR2(20),
QUARTIERE_NEG VARCHAR2(20) PRIMARY KEY,
DATA_INIZIO_NEG DATE NOT NULL,
CF_DIRIGENTE_NEG CHAR(16) NOT NULL,
CONSTRAINT FK_DIRIGENTE FOREIGN KEY (CF_DIRIGENTE_NEG) REFERENCES DIPENDENTE(CF_DIP)
);

CREATE TABLE LAVORA_IN(
DATA_IN_DIP DATE NOT NULL,
CF_LAVIN CHAR(16) NOT NULL,
QUARTIERE_LAVIN VARCHAR(20) NOT NULL,
CONSTRAINT FK_CFDIP FOREIGN KEY (CF_LAVIN) REFERENCES DIPENDENTE(CF_DIP)
ON DELETE CASCADE,
CONSTRAINT FK_QUART FOREIGN KEY (QUARTIERE_LAVIN) REFERENCES NEGOZIO(QUARTIERE_NEG),
CONSTRAINT PK_LAVORA_IN PRIMARY KEY(CF_LAVIN,QUARTIERE_LAVIN)
);

CREATE TABLE CLIENTE(
NUMERO_TEL_CLIENTE CHAR(10) PRIMARY KEY,
CAP_CLIENTE VARCHAR2(20),
CITTA_CLIENTE VARCHAR2(20),
VIA_CLIENTE VARCHAR2(20),
NOME_CLIENTE VARCHAR2(20) NOT NULL,
COGNOME_CLIENTE VARCHAR2(20) NOT NULL
);

CREATE TABLE TESSERA(
ID_TESSERA NUMBER PRIMARY KEY,
DATA_EMISSIONE_TESSERA DATE NOT NULL,
DATA_SCADENZA_TESSERA DATE NOT NULL,
NUMERO_TEL_TESSERA CHAR(10) NOT NULL,
QUARTIERE_TESSERA VARCHAR2(20) NOT NULL,
CONSTRAINT FK_NTEL FOREIGN KEY (NUMERO_TEL_TESSERA) REFERENCES CLIENTE(NUMERO_TEL_CLIENTE),
CONSTRAINT FK_QUARTIERE FOREIGN KEY (QUARTIERE_TESSERA) REFERENCES NEGOZIO(QUARTIERE_NEG)
);

CREATE TABLE CORRIERE(
NOME_CORRIERE VARCHAR2(20) NOT NULL,
CAP_CORRIERE VARCHAR2(20),
CITTA_CORRIERE VARCHAR2(20),
VIA_CORRIERE VARCHAR2(20),
PIVA_CORRIERE CHAR(11) PRIMARY KEY
);

CREATE TABLE CARRELLO(
ID_CARRELLO NUMBER PRIMARY KEY CHECK (ID_CARRELLO > 0),
ID_TESSERA_CARRELLO NUMBER,
CONSTRAINT FK_IDTESSERA FOREIGN KEY (ID_TESSERA_CARRELLO) REFERENCES TESSERA(ID_TESSERA)
);

CREATE TABLE SPEDIZIONE(
ID_CARRELLO_SPEDIZIONE NUMBER NOT NULL,
DATA_SPEDIZIONE DATE NOT NULL,
TRACKING_SPEDIZIONE VARCHAR(30) NOT NULL,
CAP_SPEDIZIONE VARCHAR2(20),
CITTA_SPEDIZIONE VARCHAR2(20),
VIA_SPEDIZIONE VARCHAR2(20),
COSTO_SPEDIZIONE NUMBER NOT NULL,
PIVA_SPEDIZIONE CHAR(11) NOT NULL,
CONSTRAINT FK_PIVA FOREIGN KEY (PIVA_SPEDIZIONE) REFERENCES CORRIERE(PIVA_CORRIERE),
CONSTRAINT PK_SPEDIZIONE PRIMARY KEY(TRACKING_SPEDIZIONE,PIVA_SPEDIZIONE),
CONSTRAINT FK_ID_CARR_SPE FOREIGN KEY (ID_CARRELLO_SPEDIZIONE) REFERENCES CARRELLO(ID_CARRELLO)
);


CREATE TABLE CASA_PROD(
PIVA_CASAPROD CHAR(11) PRIMARY KEY,
CAP_CASAPROD VARCHAR2(20),
CITTA_CASAPROD VARCHAR2(20),
VIA_CASAPROD VARCHAR2(20),
NOME_CASAPROD VARCHAR2(20) NOT NULL
);

CREATE TABLE PRODOTTO(
CODICE_PRODOTTO CHAR(13) PRIMARY KEY,
NOME_PRODOTTO VARCHAR(20) NOT NULL,
PREZZO_PRODOTTO NUMBER NOT NULL CHECK (PREZZO_PRODOTTO > 0),
PUNTI_PRODOTTO NUMBER NOT NULL CHECK (PUNTI_PRODOTTO > 0),
CATEGORIA_PRODOTTO NUMBER NOT NULL CHECK (CATEGORIA_PRODOTTO BETWEEN 0 and 4),
CP_PIVA_PRODOTTO CHAR(11) NOT NULL,
CONSTRAINT FK_CP FOREIGN KEY (CP_PIVA_PRODOTTO) REFERENCES CASA_PROD(PIVA_CASAPROD)
);

CREATE TABLE INCLUDE(
ID_INCLUDE NUMBER,
CODICE_INCLUDE CHAR(13),
SCONTO_INCLUDE NUMBER NOT NULL CHECK (SCONTO BETWEEN 1 AND 99),
QUANTITY_INCLUDE NUMBER NOT NULL CHECK (QUANTITY_INCLUDE > 0),
CONSTRAINT FK_ID FOREIGN KEY (ID_INCLUDE) REFERENCES CARRELLO(ID_CARRELLO),
CONSTRAINT FK_PRODOTTO FOREIGN KEY (CODICE_INCLUDE) REFERENCES PRODOTTO(CODICE_PRODOTTO),
CONSTRAINT PK_INCLUDE PRIMARY KEY(ID_INCLUDE,CODICE_INCLUDE)
);


CREATE TABLE FORNITORE(
NOME_FORNITORE VARCHAR2(20) NOT NULL,
PIVA_FORNITORE CHAR(11) PRIMARY KEY,
CAP_FORNITORE VARCHAR2(20),
CITTA_FORNITORE VARCHAR2(20),
VIA_FORNITORE VARCHAR2(20)
);

CREATE TABLE FORNITURA(
TRACKING_FORNITURA VARCHAR(30) UNIQUE,
DATA_FORNITURA DATE NOT NULL,
PIVA_FORNITURA CHAR(11),
QUARTIERE_FORNITURA VARCHAR2(20),
CONSTRAINT FK_FORN FOREIGN KEY (PIVA_FORNITURA) REFERENCES FORNITORE(PIVA_FORNITORE),
CONSTRAINT FK_QUARTFORN FOREIGN KEY (QUARTIERE_FORNITURA) REFERENCES NEGOZIO(QUARTIERE_NEG),
CONSTRAINT PK_FORNITURA PRIMARY KEY(TRACKING_FORNITURA,DATA_FORNITURA)
);

CREATE TABLE CONTENUTO_FORN(
CODICE_CONTFORN CHAR(13) NOT NULL,
DATA_FORNITURA_CONTFORN DATE NOT NULL,
TRACKING_CONTFORN VARCHAR(30) NOT NULL,
COSTO_CONTFORN NUMBER NOT NULL CHECK (COSTO_CONTFORN > 0),
QUANTITY_CONTFORN NUMBER NOT NULL CHECK (QUANTITY_CONTFORN > 0),
CONSTRAINT PK_CONTFORN PRIMARY KEY(TRACKING_CONTFORN,DATA_FORNITURA_CONTFORN,CODICE_CONTFORN),
CONSTRAINT FK_CONT_PROD FOREIGN KEY (CODICE_CONTFORN) REFERENCES PRODOTTO(CODICE_PRODOTTO),
CONSTRAINT FK_CONT_FORN FOREIGN KEY (TRACKING_CONTFORN) REFERENCES FORNITURA(TRACKING_FORNITURA)
);
